// Generated by CoffeeScript 1.3.3
(function() {
  var errorCallback, successCallback;

  window.URL = window.URL || window.webkitURL;

  window.AudioContext = window.AudioContext || window.mozAudioContext || window.webkitAudioContext || window.msAudioContext || window.oAudioContext;

  navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;

  successCallback = function(stream) {
    var actualFrequency, analyser, context, scriptNode, sourceNode;
    context = new AudioContext;
    sourceNode = context.createMediaStreamSource(stream);
    analyser = context.createAnalyser();
    analyser.smoothingTimeConstant = 0.3;
    analyser.fftSize = 128;
    scriptNode = context.createScriptProcessor(2048, 1, 1);
    actualFrequency = document.querySelector(".frequency .actual");
    scriptNode.onaudioprocess = function() {
      var array;
      array = new Uint8Array(analyser.frequencyBinCount);
      analyser.getByteFrequencyData(array);
      return actualFrequency.innerHTML = (array[0] + array[array.length - 1]) / 2;
    };
    sourceNode.connect(analyser);
    analyser.connect(scriptNode);
    return scriptNode.connect(context.destination);
  };

  errorCallback = function(stream) {
    return alert("Bummer");
  };

  if (navigator.getUserMedia) {
    navigator.getUserMedia({
      video: false,
      audio: true
    }, successCallback, errorCallback);
  }

}).call(this);
